#jinja2: lstrip_blocks: "True"

if [[ -f {{ config_root }}/{{ const_env_file }} ]]; then
    source {{ config_root }}/{{ const_env_file }}
fi

export DEBUG_ENDPOINTS={{ debug_endpoints }}
export COMPOSE_PROJECT_NAME={{ container_env_prefix }}
export DEPLOY_ENVIRONMENT={{ deploy_environment | default('Development') }}
export SENTRY_DISABLED=false
export SENTRY_DSN={{ sentry_dsn }}

export POSTGRES_USER=backend_user
export POSTGRES_DB=backend_db
export POSTGRES_HOST=postgres

export API_BASE_URL=api_base_url

export UWSGI_PROCESSES={{ (uwsgi_processes is defined) | ternary(uwsgi_processes, 4) }}

{% if production_setup == 'true' %}
# remap ports of nginx
export PUBLIC_NGINX_80_PORT=80:80
export PUBLIC_NGINX_443_PORT=443:443
{% else %}
export PUBLIC_NGINX_80_PORT=8080:80
export PUBLIC_NGINX_443_PORT=445:443
export POSTGRES_PASSWORD=verystrong!
{% endif %} ## if production_setup

read -d '' JWT_PUBLIC_KEY << EOF
{{ jwt_public_rsa256_key }}
EOF
export JWT_PUBLIC_KEY
